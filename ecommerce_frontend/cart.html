<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart - EcommerceApp</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar">
        <h1>EcommerceApp</h1>
        <div class="navbar-links">
            <p class="navbar-link"><a href="index.html">Home</a></p>
            <p class="navbar-link"><a href="collection.html">Collections</a></p>
            <p class="navbar-link active"><a href="cart.html">Cart</a></p>
            <p class="navbar-link"><a href="checkout.html">Orders</a></p>
        </div>
    </nav>

    <!-- Side Navbar -->
     <div class="side-navbar">
        <p style="text-align: right;" onclick="closeNavbar()">
            <i class="fa-solid fa-xmark"></i>
        </p>
        <div class="side-navbar-links">
            <p class="side-navbar-link"><a href="index.html">Home</a></p>
            <p class="side-navbar-link"><a href="collection.html">Collections</a></p>
            <p class="side-navbar-link"><a href="cart.html">Cart</a></p>
            <p class="side-navbar-link"><a href="contact.html">Contact</a></p>
        </div>
    </div>


    <!-- Cart Section -->
    <div class="cart-container">
        <h2>Your Cart</h2>
        <table class="cart-table">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="cart-items">
                <!-- Cart items will be dynamically added here -->
            </tbody>
        </table>

        <div class="cart-summary">
            <h3>Cart Summary</h3>
            <p><strong>Total Price:</strong> <span id="cart-total">$0.00</span></p>
        </div>
    </div>

    <!-- Payment Section (Updated) -->
<div id="payment-section" class="hidden">
    <h2>Payment Details</h2>
    
    <p><strong>Product:</strong> <span id="product-name"></span></p> <!-- Displays item name -->

    <form id="payment-form">
        <label>Name:</label>
        <input type="text" id="customer-name" required>

        <label>Address:</label>
        <input type="text" id="customer-address" required>

        <label>Payment Method:</label>
        <select id="payment-method" required>
            <option value="credit-card">Credit Card</option>
            <option value="paypal">PayPal</option>
            <option value="cod">Cash on Delivery</option>
        </select>

        <button type="submit">Confirm Order</button>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let cartItems = JSON.parse(localStorage.getItem("cart")) || [];
        const cartTable = document.getElementById("cart-items");
        const cartTotal = document.getElementById("cart-total");
        const paymentSection = document.getElementById("payment-section");
        const paymentForm = document.getElementById("payment-form");
        const productNameDisplay = document.getElementById("product-name");

        let selectedOrder = null; // To track the item being ordered

        function displayCart() {
            cartTable.innerHTML = "";
            let total = 0;

            if (cartItems.length === 0) {
                cartTable.innerHTML = `<tr><td colspan="5" style="text-align:center;">Your cart is empty.</td></tr>`;
            } else {
                cartItems.forEach((item, index) => {
                    let price = parseFloat(item.price) || 0;
                    let quantity = parseInt(item.quantity) || 1;
                    let itemTotal = price * quantity;
                    total += itemTotal;

                    let row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${item.name}</td>
                        <td>$${price.toFixed(2)}</td>
                        <td>${quantity}</td>
                        <td>$${itemTotal.toFixed(2)}</td>
                        <td>
                            <button class="order-now-btn" data-index="${index}">Order Now</button>
                            <button class="remove-btn" data-index="${index}">Remove</button>
                        </td>
                    `;
                    cartTable.appendChild(row);
                });
            }

            cartTotal.innerText = `$${total.toFixed(2)}`;
            attachEventListeners();
        }

        function attachEventListeners() {
            document.querySelectorAll(".order-now-btn").forEach(button => {
                button.addEventListener("click", function () {
                    const index = this.getAttribute("data-index");
                    selectedOrder = cartItems[index]; // Store selected product
                    productNameDisplay.innerText = selectedOrder.name; // Show item name in payment section
                    showPaymentForm();
                });
            });

            document.querySelectorAll(".remove-btn").forEach(button => {
                button.addEventListener("click", function () {
                    const index = this.getAttribute("data-index");
                    removeFromCart(index);
                });
            });
        }

        function showPaymentForm() {
            if (selectedOrder) {
                paymentSection.classList.remove("hidden");
                paymentSection.scrollIntoView({ behavior: "smooth" });
            }
        }

        function removeFromCart(index) {
            cartItems.splice(index, 1);
            localStorage.setItem("cart", JSON.stringify(cartItems));
            displayCart();
        }

        paymentForm.addEventListener("submit", function (event) {
            event.preventDefault();

            if (!selectedOrder) {
                alert("No item selected for order!");
                return;
            }

            const name = document.getElementById("customer-name").value;
            const address = document.getElementById("customer-address").value;
            const paymentMethod = document.getElementById("payment-method").value;

            if (name && address && paymentMethod) {
                alert(`Order placed successfully for ${selectedOrder.name}!`);

                let orders = JSON.parse(localStorage.getItem("orders")) || [];
                orders.push(selectedOrder);
                localStorage.setItem("orders", JSON.stringify(orders));

                // Remove ordered item from cart
                cartItems = cartItems.filter(item => item !== selectedOrder);
                localStorage.setItem("cart", JSON.stringify(cartItems));

                selectedOrder = null; // Reset selected order
                displayCart(); // Refresh cart

                window.location.href = "checkout.html";
            } else {
                alert("Please fill in all details!");
            }
        });

        displayCart();
    });
</script>


    <style>
        .hidden { display: none; }
        .cart-container { padding: 20px; }
        .cart-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .cart-table th, .cart-table td { padding: 10px; border: 1px solid #ddd; text-align: center; }
        .cart-summary { margin-top: 20px; font-size: 18px; }
        #payment-section { margin-top: 30px; padding: 20px; border: 1px solid #ddd; }
        input, select, button { display: block; margin: 10px 0; padding: 10px; width: 100%; }
        button { background-color: #28a745; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #218838; }
    </style>

        <!--Footer-->
        <div class="footer">
            <div class="footer-container">
                <div class="footer-box-1">
                    <h2 class="heading text">EcommerceApp</h2>
                    <p>@2025 EcommerceApp.com</p>

                    <div class = "footer-icon-container">
                        <i class = "fa-brands fa-instagram" style="color: #ffffff;"></i>
                        <i class = "fa-brands fa-twitter" style="color: #ffffff;"></i>
                        <i class = "fa-brands fa-facebook" style="color: #ffffff;"></i>
                    </div>
                    
                </div>
            </div>
        </div>
</body>
</html>
